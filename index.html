<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="基于hexo搭建的个人博客"><meta name="keywords" content="blog,liuarui"><meta name="author" content="liuarui"><meta name="copyright" content="liuarui"><title>@lm/blog | liuarui的博客</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.9.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  hexoVersion: '5.4.0'
} </script><meta name="generator" content="Hexo 5.4.0"></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="false"><div class="author-info"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">liuarui</div><div class="author-info__description text-center">基于hexo搭建的个人博客</div><div class="follow-button"><a target="_blank" rel="noopener" href="https://github.com/liuarui">Follow Me</a></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">27</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">16</span></a></div></div></div><nav class="no-bg" id="nav"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">liuarui的博客</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a></span><span class="pull-right"></span></div><div id="site-info"><div id="site-title">liuarui的博客</div><div id="site-sub-title">@lm/blog</div></div></nav><div id="content-outer"><div class="layout" id="content-inner"><div class="recent-post-item article-container"><a class="article-title" href="/2021/05/25/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E5%AD%A6%E4%B9%A0%E8%B7%AF%E5%BE%84/">No title</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-05-25</time><div class="content"><p>数据结构,操作系统，计算机网络和计算机组成原理),外加编译原理和图形学以及软件工程和软件测试。</p>
<p>以上是大前端的基础课程，可以按需所取。如果不学 node，可以省去操作系统和计算机组成原理。<br>如果不用各类预编译 less 等可以不学编译原理。<br>如果不用各类 three. js 等图形框架可以不学图形学。<br>如果不用做单元测试，可以不学软件测试……</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/04/26/JavaScript/%E5%8E%9F%E5%9E%8B/">JavaScript之原型</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-04-26</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/JavaScript/">JavaScript</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E5%8E%9F%E5%9E%8B/">原型</a></span><div class="content"><p>函数有一个属性 prototype,指向这个函数的原型对象</p>
<p>这个对象是 new 该函数产生的对象的原型</p>
<p>如</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">age</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.age = age</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> p1 = <span class="keyword">new</span> Person(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">let</span> p2 = <span class="keyword">new</span> Person(<span class="number">2</span>)</span><br></pre></td></tr></table></figure>

<p>p1 和 p2 的原型就是 Person.prototype</p>
<p>原型：对象创建的时候，会通过<code>__proto__</code>属性关联另一个对象，每个对象都会从原型中继承属性</p>
<p>每个原型都有一个<code>constructor</code>属性，执行关联的构造函数即<code>Person</code></p>
<p>原型链指的是，在找对象属性时，如果在当前对象找不到会顺着对象的原型去不断往上找</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/04/26/CSS/%E7%A7%BB%E5%8A%A8%E7%AB%AF1px%E8%BE%B9%E6%A1%86%E9%97%AE%E9%A2%98/">移动端1px边框问题</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-04-26</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/css/">css</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF/">移动端</a></span><div class="content"><ul>
<li>  使用缩放加绝对定位实现</li>
</ul>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/04/26/%E5%B7%A5%E7%A8%8B%E5%8C%96/%E8%AE%B2%E5%BA%A7%E7%AC%94%E8%AE%B0/">工程化讲座笔记</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-04-26</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E5%B7%A5%E7%A8%8B%E5%8C%96/">工程化</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E5%A4%A7%E5%89%8D%E7%AB%AF/">大前端</a></span><div class="content"><h1 id="大前端"><a href="#大前端" class="headerlink" title="大前端"></a>大前端</h1><p>不同技术栈，不能</p>
<h1 id="研发生命周期"><a href="#研发生命周期" class="headerlink" title="研发生命周期"></a>研发生命周期</h1><p>代码管理-&gt; 打包构建- &gt; CI&amp;CD -&gt; 测试 OA -&gt; 发布上线</p>
<h3 id="代码管理"><a href="#代码管理" class="headerlink" title="代码管理"></a>代码管理</h3><ul>
<li>  分支管理</li>
<li>  合并管理</li>
<li>  代码审核</li>
<li>  静态扫描</li>
</ul>
<p>gitlab<br>eslint<br>snonarQube</p>
<h3 id="打包构建"><a href="#打包构建" class="headerlink" title="打包构建"></a>打包构建</h3><ul>
<li>  依赖管理</li>
<li>  编译构建</li>
<li>  安装包加固</li>
<li>  包大小扫描</li>
</ul>
<p>webpack<br>xcode<br>android studio<br>metro</p>
<h3 id="CI-amp-CD"><a href="#CI-amp-CD" class="headerlink" title="CI&amp;CD"></a>CI&amp;CD</h3><ul>
<li>  测试环境部署</li>
<li>  APP 包体验</li>
<li>  安装包上传</li>
<li>  小程序包上传</li>
</ul>
<p>jenkins<br>docker</p>
<h3 id="测试-OA"><a href="#测试-OA" class="headerlink" title="测试 OA"></a>测试 OA</h3><ul>
<li>  单元测试</li>
<li>  Monkey 测试</li>
<li>  UI 遍历测试</li>
</ul>
<p>jest<br>Junit5<br>appium</p>
<h3 id="发布上线"><a href="#发布上线" class="headerlink" title="发布上线"></a>发布上线</h3><ul>
<li>  多渠道打包</li>
<li>  灰度发布提审</li>
<li>  生产发布提审</li>
<li>  发布管理</li>
</ul>
<p>做平台而不是做工具<br>从工具链到平台的整合<br>为了打通流程，做一个工程化平台</p>
<h3 id="工程化平台设计"><a href="#工程化平台设计" class="headerlink" title="工程化平台设计"></a>工程化平台设计</h3><ul>
<li>  支持全平台</li>
<li>  前端工程化： 提升研发效率、提升研发质量</li>
<li>  平台化：统一流程、 统一规范、统一度量</li>
</ul>
<ol>
<li>确定平台的各个模块及其范围</li>
<li>定义各个模块交付产物的标准</li>
<li>选择合适的流水线引擎</li>
<li>完善平台公共能力</li>
</ol>
<h2 id="流水线引擎设计"><a href="#流水线引擎设计" class="headerlink" title="流水线引擎设计"></a>流水线引擎设计</h2><h1 id="如何建立大前端标准化研发流程"><a href="#如何建立大前端标准化研发流程" class="headerlink" title="如何建立大前端标准化研发流程"></a>如何建立大前端标准化研发流程</h1><ol>
<li>定义各平台支付产物的标准</li>
<li>流水线统一标准化前端工作流</li>
<li>统一团队研发方式和流程</li>
</ol>
<p>统一研发规范<br>如果只是文档形式，落地难<br>使用静态代码扫描</p>
<p>工程化理解<br>从你打开编辑器敲下一次字母开始，到最终产物上线，下线的，所要经历过的一系列流程都属于工程化</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/04/26/%E6%A1%86%E6%9E%B6/next.js/%E6%9C%8D%E5%8A%A1%E7%AB%AF%E9%A2%84%E6%B8%B2%E6%9F%93/">next.js之服务端预渲染</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-04-26</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E6%A1%86%E6%9E%B6/">框架</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/next-js/">next.js</a></span><div class="content"><p>预渲染可以带来更好的性能和 SEO。</p>
<h2 id="Ssg-静态生成：构建时生成"><a href="#Ssg-静态生成：构建时生成" class="headerlink" title="Ssg 静态生成：构建时生成"></a>Ssg 静态生成：构建时生成</h2><p><img src="https://www.nextjs.cn/static/images/learn/data-fetching/static-generation.png" alt="static-generation"></p>
<ul>
<li><p>  静态生成不代表无需数据</p>
</li>
<li><p>  使用 getStaticProps</p>
</li>
</ul>
<h2 id="ssr-服务端渲染：使用请求然后通过请求生成-html"><a href="#ssr-服务端渲染：使用请求然后通过请求生成-html" class="headerlink" title="ssr 服务端渲染：使用请求然后通过请求生成 html"></a>ssr 服务端渲染：使用请求然后通过请求生成 html</h2><p><img src="https://www.nextjs.cn/static/images/learn/data-fetching/server-side-rendering.png" alt="static-generation"></p>
<ul>
<li>  使用 getServerSideProps</li>
</ul>
<h2 id="csr-客户端渲染"><a href="#csr-客户端渲染" class="headerlink" title="csr 客户端渲染"></a>csr 客户端渲染</h2><p><img src="https://www.nextjs.cn/static/images/learn/data-fetching/client-side-rendering.png" alt="client-side-rendering"></p>
<ul>
<li><p>  如果你不做需要预先渲染的数据，可使用 csr</p>
</li>
<li><p>  不需要 seo 的部分可以使用 csr</p>
</li>
</ul>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/04/26/%E6%A1%86%E6%9E%B6/next.js/%E5%8A%A8%E6%80%81%E8%B7%AF%E7%94%B1/">next.js之动态路由</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-04-26</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E6%A1%86%E6%9E%B6/">框架</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/next-js/">next.js</a></span><div class="content"><h3 id="整体逻辑"><a href="#整体逻辑" class="headerlink" title="整体逻辑"></a>整体逻辑</h3><p><img src="https://www.nextjs.cn/static/images/learn/dynamic-routes/how-to-dynamic-routes.png" alt="how-to-dynamic-routes"></p>
<h3 id="getStaticPaths"><a href="#getStaticPaths" class="headerlink" title="getStaticPaths"></a>getStaticPaths</h3><ul>
<li><p>  需要使用<a target="_blank" rel="noopener" href="https://www.nextjs.cn/docs/basic-features/data-fetching#getstaticpaths-static-generation"><code>getStaticPaths</code></a>返回一个对象，其中<code>path</code>包含动态路由所有的可能值</p>
</li>
<li><p>```js<br>  export async function getStaticPaths() {</p>
<pre><code>  const paths = getAllPostIds()
  return &#123;
      paths,
      fallback: false,
  &#125;
</code></pre>
<p>  }</p>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### fallback</span><br><span class="line"></span><br><span class="line">如果[`fallback`是`false`](https://www.nextjs.cn/docs/basic-features/data-fetching#fallback-false)，则任何未返回的路径[`getStaticPaths`](https://www.nextjs.cn/docs/basic-features/data-fetching#getstaticpaths-static-generation)都将产生**404 页面**。</span><br><span class="line"></span><br><span class="line">如果[`fallback`为`true`](https://www.nextjs.cn/docs/basic-features/data-fetching#fallback-true)，则[`getStaticProps`](https://www.nextjs.cn/docs/basic-features/data-fetching#getstaticprops-static-generation)更改行为：</span><br><span class="line"></span><br><span class="line">-   返回的路径[`getStaticPaths`](https://www.nextjs.cn/docs/basic-features/data-fetching#getstaticpaths-static-generation)将在构建时呈现为 HTML。</span><br><span class="line">-   还没有在生成时生成的路径将**不会**导致 404 页。相反，Next.js 将在对此类路径的第一个请求时提供页面的“后备”版本。</span><br><span class="line">-   在后台，Next.js 将静态生成请求的路径。对同一路径的后续请求将服务于生成的页面，就像在构建时预渲染的其他页面一样。</span><br><span class="line"></span><br><span class="line">### 通配路由</span><br><span class="line"></span><br><span class="line">在文件名中使用`...`，可匹配所有具备前置路径的文件</span><br><span class="line"></span><br><span class="line">-   `pages/posts/[...id].js` matches `/posts/a`, but also `/posts/a/b`, `/posts/a/b/c` and so on.</span><br><span class="line"></span><br><span class="line">-   需要返回的匹配为数组</span><br><span class="line"></span><br><span class="line">```js</span><br><span class="line">export async function getStaticPaths() &#123;</span><br><span class="line">    const paths = [</span><br><span class="line">        &#123;</span><br><span class="line">            params: &#123;</span><br><span class="line">                id: [&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;],</span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">    ]</span><br><span class="line">    return &#123;</span><br><span class="line">        paths,</span><br><span class="line">        fallback: false,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="404page"><a href="#404page" class="headerlink" title="404page"></a>404page</h3><p>创建<code>/pages/404.js</code></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/04/26/%E6%A1%86%E6%9E%B6/snion%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/General%20setup/">snion中文文档 General setup</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-04-26</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E7%BF%BB%E8%AF%91/">翻译</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E6%A1%86%E6%9E%B6/">框架</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/snion/">snion</a></span><div class="content"><h1 id="通用配置-Sinon-js"><a href="#通用配置-Sinon-js" class="headerlink" title="通用配置 -Sinon.js"></a>通用配置 -Sinon.js</h1><ul>
<li>  <code>Sinon</code>用于创建<code>fakes</code>， <code>spies</code> 和 <code>stubs</code>。</li>
<li>  默认情况下，它们是在<em>默认沙箱</em>中创建的。 因此我们需要确保在每次测试后还原沙箱。</li>
</ul>
<p>举个例子，如果您使用的是 Mocha，则可以将还原沙箱的操作放在根目录下的测试文件中：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">afterEach(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// Restore the default sandbox here</span></span><br><span class="line">    sinon.restore()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>或者在<code>Jasmine</code>中，您应该将其放在每个描述中：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">describe(<span class="string">&#x27;My test suite&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    afterEach(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// Restore the default sandbox here</span></span><br><span class="line">        sinon.restore()</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><em>忘记还原沙箱会导致内存泄漏。</em><br><em>有关使用多个沙箱的更高级设置，请参阅<a target="_blank" rel="noopener" href="https://sinonjs.org/releases/v9.2.4/sandbox">沙箱</a></em></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/04/26/%E6%A1%86%E6%9E%B6/snion%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/Fakes/">snion中文文档 Fakes</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-04-26</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E7%BF%BB%E8%AF%91/">翻译</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E6%A1%86%E6%9E%B6/">框架</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/snion/">snion</a></span><div class="content"><h1 id="Fakes"><a href="#Fakes" class="headerlink" title="Fakes"></a>Fakes</h1><h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><ul>
<li>  <code>fake</code>从 v5 版本开始可在 Sinon 中使用。</li>
<li>  fake 拥有创建具有设置默认<a target="_blank" rel="noopener" href="https://sinonjs.org/releases/v9.2.4/fakes/#fakes-with-behavior">行为</a>的 <code>fake Function</code> 功能。</li>
<li>  使用具有与<code>sinon.stub</code>中相同的 API 的<code>Functions</code>来设/Users/lm/Desktop/note/snion 中文文档/Fakes.md 置<a target="_blank" rel="noopener" href="https://sinonjs.org/releases/v9.2.4/fakes/#fakes-with-behavior">行为</a></li>
<li>  创建的具有或不具有行为的<code>fake Function</code>具有与（<code>sinon.spy</code>)<a target="_blank" rel="noopener" href="https://sinonjs.org/releases/v9.2.4/spies"><code>spies</code></a>相同的 API。</li>
</ul>
<p>在 <code>Sinon</code> 中，<code>fake</code> 是一个 <code>Function</code> 它记录其所有调用的参数，返回值，this 的值和引发的异常（如果有）。<br><code>fake</code>是不变的：一旦创建，行为就不会改变。</p>
<p>与 <code>sinon.spy</code> 和 <code>sinon.stub</code> 方法不同，<code>sinon.fakeAPI</code> 仅关注如何创建 fake，而与将<code>fake</code>插入被测系统无关。<br>要将<code>fake</code>插入被测系统，可以使用这些 <a target="_blank" rel="noopener" href="https://sinonjs.org/releases/v9.2.4/sandbox#sandboxreplaceobject-property-replacement"><code>sinon.replace\*</code></a>方法。</p>
<h2 id="创建一个-fake"><a href="#创建一个-fake" class="headerlink" title="创建一个 fake"></a>创建一个 <code>fake</code></h2><p>创建一个有或没有行为的<code>fake Function</code>， 创建的函数都将具有与 <code>sinon.spy</code> 相同的 API。</p>
<ul>
<li>  Creating a fake without behavior</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// create a basic fake, with no behavior</span></span><br><span class="line"><span class="keyword">var</span> fake = sinon.fake()</span><br><span class="line"></span><br><span class="line">fake()</span><br><span class="line"><span class="comment">// undefined</span></span><br><span class="line"></span><br><span class="line">fake.callCount</span><br><span class="line"><span class="comment">// 1</span></span><br></pre></td></tr></table></figure>

<ul>
<li>  Creating a fake with custom behaviour</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// create a fake that returns the text &quot;foo&quot;</span></span><br><span class="line"><span class="keyword">var</span> fake = sinon.fake.returns(<span class="string">&#x27;foo&#x27;</span>)</span><br><span class="line"></span><br><span class="line">fake()</span><br><span class="line"><span class="comment">// foo</span></span><br></pre></td></tr></table></figure>

<h2 id="Fakes-的行为"><a href="#Fakes-的行为" class="headerlink" title="Fakes 的行为"></a>Fakes 的行为</h2><p>行为一旦创造，就无法改变。</p>
<h3 id="sinon-fake-returns-value"><a href="#sinon-fake-returns-value" class="headerlink" title="sinon.fake.returns(value);"></a>sinon.fake.returns(value);</h3><p>创建返回值参数的 fake。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fake = sinon.fake.returns(<span class="string">&#x27;apple pie&#x27;</span>)</span><br><span class="line"></span><br><span class="line">fake()</span><br><span class="line"><span class="comment">// apple pie</span></span><br></pre></td></tr></table></figure>

<h3 id="sinon-fake-throws-value"><a href="#sinon-fake-throws-value" class="headerlink" title="sinon.fake.throws(value);"></a>sinon.fake.throws(value);</h3><p>创建一个 fake，该 fake 将使用提供的值作为 message 属性抛出 Error。</p>
<p>如果将 Error 作为 value 参数传递，则将作为抛出的值。 如果传递了任何其他值，则该值将用于引发 Error 的 message 属性。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fake = sinon.fake.throws(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&#x27;not apple pie&#x27;</span>))</span><br><span class="line"></span><br><span class="line">fake()</span><br><span class="line"><span class="comment">// Error: not apple pie</span></span><br></pre></td></tr></table></figure>

<h3 id="sinon-fake-resolves-value"><a href="#sinon-fake-resolves-value" class="headerlink" title="sinon.fake.resolves(value);"></a>sinon.fake.resolves(value);</h3><p>Creates a fake that returns a resolved Promise for the passed value.</p>
<h3 id="sinon-fake-rejects-value"><a href="#sinon-fake-rejects-value" class="headerlink" title="sinon.fake.rejects(value);"></a>sinon.fake.rejects(value);</h3><p>Creates a fake that returns a rejected Promise for the passed value.<br>如果错误被作为值参数传递，那么这将是 promise 的价值。<br>如果传递了其他任何值，则该值将用于 promise 返回的 Error 的 message 属性。</p>
<h3 id="sinon-fake-yields-value1-…-valueN"><a href="#sinon-fake-yields-value1-…-valueN" class="headerlink" title="sinon.fake.yields([value1, …, valueN]);"></a>sinon.fake.yields([value1, …, valueN]);</h3><p>sinon.fake.yields takes some values, and returns a function that when being called, expects the last argument to be a callback and invokes that callback with the same previously given values. The returned function is normally used to fake a service function that takes a callback as the last argument.</p>
<p>In code example below, the ‘readFile’ function of the ‘fs’ module is replaced with a fake function created by sinon.fake.yields. When the fake function is called, it always calls the last argument it received, which is expected to be a callback, with the values that the yields function previously took.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fake = sinon.fake.yields(<span class="literal">null</span>, <span class="string">&#x27;file content&#x27;</span>)</span><br><span class="line">sinon.replace(fs, <span class="string">&#x27;readFile&#x27;</span>, fake)</span><br><span class="line">fs.readFile(<span class="string">&#x27;somefile&#x27;</span>, <span class="function">(<span class="params">err, data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(data)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;end of this event loop&#x27;</span>)</span><br><span class="line"><span class="comment">// file content</span></span><br><span class="line"><span class="comment">// end of this event loop</span></span><br></pre></td></tr></table></figure>

<h3 id="sinon-fake-yieldsAsync-value1-…-valueN"><a href="#sinon-fake-yieldsAsync-value1-…-valueN" class="headerlink" title="sinon.fake.yieldsAsync([value1, …, valueN]);"></a>sinon.fake.yieldsAsync([value1, …, valueN]);</h3><p>Similar to yields, yieldsAsync also returns a function that when invoked, the function expects the last argument to be a callback and invokes that callback with the same previously given values. However, the returned function invokes that callback asynchronously rather than immediately, i.e. in the next event loop.</p>
<p>Compare the output of the code example below with the output of the code example above for yields to see the difference.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fakeAsync = sinon.fake.yieldsAsync(<span class="literal">null</span>, <span class="string">&#x27;file content&#x27;</span>)</span><br><span class="line">sinon.replace(fs, <span class="string">&#x27;readFile&#x27;</span>, fakeAsync)</span><br><span class="line">fs.readFile(<span class="string">&#x27;somefile&#x27;</span>, <span class="function">(<span class="params">err, data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(data)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;end of this event loop&#x27;</span>)</span><br><span class="line"><span class="comment">// end of this event loop</span></span><br><span class="line"><span class="comment">// file content</span></span><br></pre></td></tr></table></figure>

<h3 id="sinon-fake-func"><a href="#sinon-fake-func" class="headerlink" title="sinon.fake(func);"></a>sinon.fake(func);</h3><p>Wraps an existing Function to record all interactions, while leaving it up to the func to provide the behavior.</p>
<p>The created fake Function has the same API as a sinon.spy.</p>
<p>This is useful when complex behavior not covered by the sinon.fake.* methods is required or when wrapping an existing function or method.</p>
<h2 id="Instance-properties"><a href="#Instance-properties" class="headerlink" title="Instance properties"></a>Instance properties</h2><p>The instance properties are the same as a sinon.spy.</p>
<h3 id="f-callback"><a href="#f-callback" class="headerlink" title="f.callback"></a>f.callback</h3><p>This property is a convenience to get a reference to the last callback passed in the last to the fake.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> f = sinon.fake()</span><br><span class="line"><span class="keyword">var</span> cb1 = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="keyword">var</span> cb2 = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">f(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, cb1)</span><br><span class="line">f(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, cb2)</span><br><span class="line"></span><br><span class="line">f.callback === cb2</span><br><span class="line"><span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<p>The same convenience has been added to spy calls:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">f.getCall(<span class="number">1</span>).callback === cb2</span><br><span class="line"><span class="comment">// true</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line">f.lastCall.callback === cb2</span><br><span class="line"><span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<h3 id="f-firstArg"><a href="#f-firstArg" class="headerlink" title="f.firstArg"></a>f.firstArg</h3><p>This property is a convenient way to get a reference to the first argument passed in the last call to the fake.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> f = sinon.fake()</span><br><span class="line"><span class="keyword">var</span> date1 = <span class="keyword">new</span> <span class="built_in">Date</span>()</span><br><span class="line"><span class="keyword">var</span> date2 = <span class="keyword">new</span> <span class="built_in">Date</span>()</span><br><span class="line"></span><br><span class="line">f(date1, <span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">f(date2, <span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">f.firstArg === date2</span><br><span class="line"><span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<h3 id="f-lastArg"><a href="#f-lastArg" class="headerlink" title="f.lastArg"></a>f.lastArg</h3><p>This property is a convenient way to get a reference to the last argument passed in the last call to the fake.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> f = sinon.fake()</span><br><span class="line"><span class="keyword">var</span> date1 = <span class="keyword">new</span> <span class="built_in">Date</span>()</span><br><span class="line"><span class="keyword">var</span> date2 = <span class="keyword">new</span> <span class="built_in">Date</span>()</span><br><span class="line"></span><br><span class="line">f(<span class="number">1</span>, <span class="number">2</span>, date1)</span><br><span class="line">f(<span class="number">1</span>, <span class="number">2</span>, date2)</span><br><span class="line"></span><br><span class="line">f.lastArg === date2</span><br><span class="line"><span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<p>The same convenience has been added to spy calls:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">f.getCall(<span class="number">0</span>).lastArg === date1</span><br><span class="line"><span class="comment">// true</span></span><br><span class="line">f.getCall(<span class="number">1</span>).lastArg === date2</span><br><span class="line"><span class="comment">// true</span></span><br><span class="line"></span><br><span class="line">f.lastCall.lastArg === date2</span><br><span class="line"><span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<h2 id="Adding-the-fake-to-the-system-under-test"><a href="#Adding-the-fake-to-the-system-under-test" class="headerlink" title="Adding the fake to the system under test"></a>Adding the fake to the system under test</h2><p>Unlike sinon.spy and sinon.stub, sinon.fake only knows about creating fakes, not about replacing properties in the system under test.</p>
<p>To replace a property, you can use the sinon.replace method.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fake = sinon.fake.returns(<span class="string">&#x27;42&#x27;</span>)</span><br><span class="line"></span><br><span class="line">sinon.replace(<span class="built_in">console</span>, <span class="string">&#x27;log&#x27;</span>, fake)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;apple pie&#x27;</span>)</span><br><span class="line"><span class="comment">// 42</span></span><br></pre></td></tr></table></figure>

<p>When you want to restore the replaced properties, call the sinon.restore method.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// restores all replaced properties set by sinon methods (replace, spy, stub)</span></span><br><span class="line">sinon.restore()</span><br></pre></td></tr></table></figure>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/04/21/HTML/%E6%A0%87%E7%AD%BE/">HTML标签相关</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-04-21</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/HTML/">HTML</a></span><div class="content"><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 重定向 --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- &lt;meta http-equiv=&quot;refresh&quot; content=&quot;1;url=http://www.baidu.com&quot; /&gt; --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;prerender&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://www.tabao.com&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;https://www.taobao.com&quot;</span>&gt;</span>去淘宝<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="meta"><a href="#meta" class="headerlink" title="meta"></a>meta</h1><p>属性</p>
<ul>
<li><p>  <code>contend</code></p>
</li>
<li><p><code>http-equiv</code>[content-type | expires | refresh | set-cookie]</p>
<ul>
<li><p>  把 content 属性关联到 HTTP 头部。</p>
</li>
<li><p>  http-equiv 属性为名称/值对提供了名称。并指示服务器在发送实际的文档之前先在要传送给浏览器的 MIME 文档头部包含名称/值对。</p>
</li>
<li><p>  当服务器向浏览器发送文档时，会先发送许多名称/值对。虽然有些服务器会发送许多这种名称/值对，但是所有服务器都至少要发送一个：content-type:text/html。这将告诉浏览器准备接受一个 HTML 文档。</p>
</li>
<li><p>  使用带有 http-equiv 属性的 <meta> 标签时，服务器将把名称/值对添加到发送给浏览器的内容头部。例如，添加：</p>
</li>
</ul>
</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;charset&quot;</span> <span class="attr">content</span>=<span class="string">&quot;iso-8859-1&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;expires&quot;</span> <span class="attr">content</span>=<span class="string">&quot;31 Dec 2008&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">这样发送到浏览器的头部就应该包含：</span><br><span class="line">content-type: text/html</span><br><span class="line">charset:iso-8859-1</span><br><span class="line">expires:31 Dec 2008</span><br><span class="line">当然，只有浏览器可以接受这些附加的头部字段，并能以适当的方式使用它们时，这些字段才有意义。</span><br></pre></td></tr></table></figure>

<ul>
<li><code>name</code><br>  可选值<ul>
<li>  author</li>
<li>  description</li>
<li>  keywords</li>
<li>  generator</li>
<li>  revised</li>
<li>  others</li>
</ul>
</li>
<li><code>scheme</code><br>  定义用于翻译 content 属性值的格式。</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;keywords&quot;</span> <span class="attr">contend</span>=<span class="string">&quot;关键词1,关键词2&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="script"><a href="#script" class="headerlink" title="script"></a>script</h1><ul>
<li><code>async </code><ul>
<li>  无顺序，谁先加载完成谁先执行</li>
</ul>
</li>
<li><code>defer</code><ul>
<li>  启动一个新线程去下载，然后在<code>DOMContentLoaded</code>事件执行前执行脚本</li>
<li>  多个按先后顺序</li>
</ul>
</li>
</ul>
<h1 id="link"><a href="#link" class="headerlink" title="link"></a>link</h1><ul>
<li>  <code>prefetch</code></li>
<li>  <code>prerender</code></li>
<li>  <code>preload</code></li>
</ul>
<h1 id="canvas"><a href="#canvas" class="headerlink" title="canvas"></a>canvas</h1><ul>
<li>  canvas API</li>
<li>  webGL API</li>
</ul>
<h1 id="svg"><a href="#svg" class="headerlink" title="svg"></a>svg</h1><p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/SVG">https://developer.mozilla.org/zh-CN/docs/Web/SVG</a></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/02/01/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/Why%20I%20use%20Tape%20Instead%20of%20Mocha%20&amp;%20So%20Should%20You/">Why I use Tape Instead of Mocha &amp; So Should You</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-02-01</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/">单元测试</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E7%BF%BB%E8%AF%91/">翻译</a></span><div class="content"><h1 id="Why-I-use-Tape-Instead-of-Mocha-amp-So-Should-You"><a href="#Why-I-use-Tape-Instead-of-Mocha-amp-So-Should-You" class="headerlink" title="Why I use Tape Instead of Mocha &amp; So Should You"></a>Why I use Tape Instead of Mocha &amp; So Should You</h1><h1 id="为什么我要使用-Tape-来替代-Mocha-amp-你也应该这么评估软件质量"><a href="#为什么我要使用-Tape-来替代-Mocha-amp-你也应该这么评估软件质量" class="headerlink" title="为什么我要使用 Tape 来替代 Mocha &amp; 你也应该这么评估软件质量"></a>为什么我要使用 Tape 来替代 Mocha &amp; 你也应该这么评估软件质量</h1><p>作者<a target="_blank" rel="noopener" href="https://medium.com/@_ericelliott?source=post_page-----6aa105d8eaf4--------------------------------">Eric Elliott</a></p>
<p>写作时间：Jul 13, 2015</p>
<blockquote>
<p><em>TL;DR: Mocha is a $150k Porsche Panamera when the best tool for the job is a $30k Tesla Model 3. Don’t waste your resources on testing bells and whistles. Invest them in creating your app, instead.</em> &gt;<em>总结: Mocha 是一个价值 150 刀的保时捷，但是往往我们工作中只需要 30 刀的特斯拉就能带来最好的效益。不要为了使用一个测试软件而去使用测试软件，而是使用他们来驱动你的程序开发。</em><br>UPDATE: I have written a simplified wrapper around Tape to make it even simpler to write great unit tests which provide clear bug reports when they fail. See <a target="_blank" rel="noopener" href="https://medium.com/javascript-scene/rethinking-unit-test-assertions-55f59358253f">“Rethinking Unit Test Assertions”</a> for more details.<br>UPDATE：我对 Tape 进行了简易封装，使它能够更容易的编写出优秀的单元测试，且能够在测试用例未通过时提供清晰的错误报告，有关其更多信息请参考 <a target="_blank" rel="noopener" href="https://medium.com/javascript-scene/rethinking-unit-test-assertions-55f59358253f">“Rethinking Unit Test Assertions”</a></p>
</blockquote>
<p>Sometimes popularity is an indication of quality. Other times, popular things are popular for popularity’s sake, and not because they’re better than alternatives.</p>
<p>一般而言，受欢迎程度反映了事物的质量。但有时，受欢迎的事物只是因为受欢迎而受欢迎，而不是因为它们比非主流的更好。</p>
<p>On real production projects, I have used Jasmine, Mocha, NodeUnit, Tape, and a bunch of other solutions. I have investigated <em>many other options.</em> For the last few years, I have used and continue to use <a target="_blank" rel="noopener" href="https://github.com/substack/tape">Tape</a> along with Supertest (for API testing) on all of my personal projects and projects that I lead.</p>
<p>在实际的生产项目中，我曾使用过 Jasmine，Mocha，NodeUnit，Tape 和许多其他解决方案。我研究过各种框架。但是在过去的几年中，我在我所有的个人项目和我主导的项目中都使用并继续使用<a target="_blank" rel="noopener" href="https://github.com/substack/tape">Tape</a>和 Supertest（用于 API 测试）。</p>
<h2 id="What-are-Unit-tests"><a href="#What-are-Unit-tests" class="headerlink" title="What are Unit tests?"></a>What are Unit tests?</h2><h2 id="什么是单元测试？"><a href="#什么是单元测试？" class="headerlink" title="什么是单元测试？"></a>什么是单元测试？</h2><p>Unit tests exist to test individual units of software functionality. A unit is a module, component, or function. They’re bits of the program that can work independently of the rest of the program. The presence of unit testing implies that the software is designed in a modular fashion. You may hear once in a while that there are ways to make software “more testable.”</p>
<p>单元测试常见于测试软件功能的各个单元。单元是可以是一个模块，组件或函数。它们是程序的一部分，可以独立于程序的其余部分工作。单元测试的存在意味着该软件是以模块化方式设计的。您可能偶尔会听到有一些使软件“更具可测试性”的方法。</p>
<p>If you find that it’s hard to write unit tests for your program without mocking lots of other things, that’s a sign that your program is not modular enough. Revealing tight coupling (the opposite of modularity) is one of the many important roles that unit tests play in software creation.</p>
<p>如果您发现很难在不模拟许多其他事情的情况下为程序编写单元测试，则表明您的程序不够模块化。发现耦合（与模块化相反）是单元测试在软件开发中扮演的许多重要功能之一。</p>
<p>Every module should have unit tests, and every application should be made up of modules. In other words, if you’re not writing unit tests, you should be.</p>
<p>每个模块都应该有单元测试，每个应用程序都应该由模块组成。换句话说，如果您不编写单元测试，则更应该这么做。</p>
<h2 id="What’s-Wrong-with-Mocha-Jasmine-etc…"><a href="#What’s-Wrong-with-Mocha-Jasmine-etc…" class="headerlink" title="What’s Wrong with Mocha, Jasmine, etc…?"></a>What’s Wrong with Mocha, Jasmine, etc…?</h2><h2 id="Mocha，Jasmine-等框架都存在什么问题？"><a href="#Mocha，Jasmine-等框架都存在什么问题？" class="headerlink" title="Mocha，Jasmine 等框架都存在什么问题？"></a>Mocha，Jasmine 等框架都存在什么问题？</h2><ol>
<li><p><strong>Too much configuration :</strong> Choose an assertion library, chose a reporting library, chose a task runner (Grunt, Gulp, etc…) Then figure out how to translate the documentation examples to the reporting library / task runner you chose. All of this is too much cognitive load. Vs: Choose Tape. Done.</p>
</li>
<li><p>**Globals: **Mocha, Jasmine, and several other alternatives pollute the global environment with functions like <code>describe</code>, <code>it</code>, etc… Some assertion libraries extend built-in prototypes. Aside from removing the self-documenting nature of simple module exports, those decisions could potentially conflict with the code you’re trying to test. Vs: Tape’s simple module export.</p>
</li>
<li><p><strong>Shared State:</strong> Functions like <em><code>beforeEach</code></em> and <em><code>afterEach</code></em> actively encourage you to do something you <strong>definitely should not do</strong>: Share state between tests. <em>Vs. Tape: No such functions for global state sharing. Instead, call setup and teardown routines from individual tests, and</em> <strong>*contain all state to local test variables.*</strong></p>
</li>
<li><p><strong>过多的配置项：</strong>选择一个断言库，选择一个报告库，选择一个任务组织器 (Grunt, Gulp, etc…)，然后还得学习你所选择的报告库和任务组织器的文档示例，学习成本过高。相比之下：选择使用 Tape，完事～</p>
</li>
<li><p><strong>全局变量：</strong>Mocha，Jasmine 等等通过<code>describe</code>，<code>it</code>等全局函数污染全局环境。某些断言库扩展了内置原型。除了破坏了模块的纯净性以外，这些操作还可能与您要测试的代码冲突。相比下：Tape 的纯净模块导出。</p>
</li>
<li><p><strong>共享状态：</strong>诸如*<code>beforeEach</code><em>和</em><code>afterEach</code>之类的功能*积极地鼓励您做一些您<strong>绝对不应该做的事情</strong>：在测试之间共享状态。相比下： Tape 没有用于全局状态共享的此类功能。取而代之的是，从制定的测试用例中调用挂载和卸载，并将所有状态包含在本地测试变量中。</p>
</li>
</ol>
<h2 id="Why-Tape"><a href="#Why-Tape" class="headerlink" title="Why Tape?"></a>Why Tape?</h2><h2 id="为什么选择-Tape？"><a href="#为什么选择-Tape？" class="headerlink" title="为什么选择 Tape？"></a>为什么选择 Tape？</h2><p>Mocha does way too much and gives developers way too many assertion choices, and that leads to <a target="_blank" rel="noopener" href="http://en.wikipedia.org/wiki/Analysis_paralysis">analysis paralysis</a> and lost productivity. Every time I have seen Mocha used on a project, I’ve seen developers dump way too much time in the testing framework and testing environment.</p>
<p>Mocha 给了开发者太多的断言库选择，这导致<a target="_blank" rel="noopener" href="http://en.wikipedia.org/wiki/Analysis_paralysis">分析瘫痪</a>和降低了生产效率。每当 Mocha 在项目中使用时，我都看到开发人员搭建在测试框架和测试环境过程中浪费了太多时间。</p>
<p>While I’m ranting I would be remiss if I didn’t mention that if you spend a lot of time on mocks and stubs, that’s a strong code-smell. You can probably dramatically simplify both your tests and your application by breaking your app into more modular chunks.</p>
<p>我很想告诉你，如果您在 mocks 和 stubs 上花费大量时间，那说明你跑偏了，这是一种很糟糕的事情。因为往往将应用程序划分为更多的模块，您就能过极大地简化测试和应用程序。</p>
<h2 id="Mocking-is-a-code-smell"><a href="#Mocking-is-a-code-smell" class="headerlink" title="Mocking is a code smell."></a>Mocking is a code smell.</h2><h2 id="过重的-Mock-是一中糟糕的编码习惯"><a href="#过重的-Mock-是一中糟糕的编码习惯" class="headerlink" title="过重的 Mock 是一中糟糕的编码习惯"></a>过重的 Mock 是一中糟糕的编码习惯</h2><p>A few simple mocks here and there are OK. Some of your app will inevitably involve side-effects (reading from or writing to the network or filesystem, for instance). When you do have a genuine need for mocks, keep them simple. Little more than basic stubs are ideal. But on many projects, I’ve seen a lot of over-complicated mocks that never needed to exist in the first place. Why maintain more code than you need to?<br>The more you break your problems down into simple, pure functions, the easier it will be to test your code without mocks.<br>一些简单的 Mocking 可以接受。部分情况下，您的某些应用程序不可避免地会被带入副作用（例如，从网络或文件系统读取或写入网络或文件系统）。当您确实需要 Mock 时，请尽量使其简单。采用更多基础 stubs 是不错的主意。但是在许多项目中，我看到了很多过于复杂的 Mock，这些 Mock 从一开始就不需要存在。为什么要维护比您所需更多的代码？<br>将问题分解成简单的<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Pure_function">纯</a> <a target="_blank" rel="noopener" href="https://medium.com/javascript-scene/the-two-pillars-of-javascript-pt-2-functional-programming-a63aa53a41a4">函数</a>的次数越多，_无需 Mock 就可以测试代码_。</p>
<h2 id="Testing-is-not-what-you-should-spend-most-of-your-time-doing"><a href="#Testing-is-not-what-you-should-spend-most-of-your-time-doing" class="headerlink" title="Testing is not what you should spend most of your time doing."></a>Testing is not what you should spend most of your time doing.</h2><h2 id="你不应该投入大量时间去编写测试用例"><a href="#你不应该投入大量时间去编写测试用例" class="headerlink" title="你不应该投入大量时间去编写测试用例"></a>你不应该投入大量时间去编写测试用例</h2><p>You should spend most of your time thinking about how to create the best, most flexible, most performant solutions given the afforded time constraints. Time is value in the software development world, and you shouldn’t waste one minute of it.</p>
<p>在有限时间的开发周期内下，您应将大部分时间都花在如何创建更好，更灵活，更高性能的解决方案上。在软件开发世界中，时间很重要，您不应该浪费时间。</p>
<p>If you get your kicks burning money, use Mocha, Jasmine, Jest, etc… But if you value your time, keep reading.</p>
<p>如果并无所谓，可以使用 Mocha，Jasmine，Jest 等。但是，如果您珍惜你的时间，请继续阅读。</p>
<p>With many BDD assertion libraries, there are getters with side effects. At one company I worked for (not naming names), that buried a bug in one of our tests, and we spent far too long debugging the test case rather than developing actual application code.</p>
<p>在许多 BDD 断言库中，他们都有些带有副作用的 getters。在我工作的一家公司（没有命名），这在我们的一个测试中掩埋了一个错误，并且我们花了太多的时间调试测试用例，而不是开发实际的应用程序代码。</p>
<h2 id="Test-assertions-should-be-dead-simple-amp-completely-free-of-magic"><a href="#Test-assertions-should-be-dead-simple-amp-completely-free-of-magic" class="headerlink" title="Test assertions should be dead simple,&amp; completely free of magic."></a>Test assertions should be dead simple,&amp; <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Magic_(programming)">completely free of magic</a>.</h2><h2 id="测试断言应该尽可能的简单，并且完全没有黑魔法（不带入除应有实现的实现）"><a href="#测试断言应该尽可能的简单，并且完全没有黑魔法（不带入除应有实现的实现）" class="headerlink" title="测试断言应该尽可能的简单，并且完全没有黑魔法（不带入除应有实现的实现）"></a>测试断言应该尽可能的简单，并且完全没有黑魔法（不带入除应有实现的实现）</h2><p><em><code>equal</code></em>, <em><code>deepEqual</code></em>, <em><code>pass</code></em> &amp; <em><code>fail</code></em> are my primary go-to assertions. If <em><code>equal</code></em> and <em><code>deepEqual</code></em> were the only assertions available anywhere, the testing world would probably be better off for it.</p>
<p>Why? <em><code>equal</code></em> &amp; <em><code>deepEqual</code></em> provide quality information about expectations, and they lead to very concise test cases that are <strong>easy to read &amp; maintain.</strong></p>
<p>When you write a bug report, you should always <em>provide a description,</em> explain <em>what you expected to see</em>, and explain <em>what you actually saw</em>.</p>
<p>Test cases should be written in much the same way:</p>
<ol>
<li>Describe the feature that you’re testing in plain English.</li>
<li>Provide the expected outcome of the test. This part is why many unit tests are called <em>expectations.</em></li>
<li>Compare that to the <em>actual value.</em></li>
</ol>
<p>When a unit tests fails, <em>the error message is your bug report.</em></p>
<p><em><code>equal</code></em>, <em><code>deepEqual</code></em>, <em><code>pass</code></em> &amp; <em><code>fail</code></em> 是我常用的断言。如果*<code>equal</code>* and <em><code>deepEqual</code></em> 是唯一可用的断言，那么测试可读性会变得更好。</p>
<p>为什么？_<code>equal</code>_ &amp; <em><code>deepEqual</code></em> 提供有关期望的质量信息，它们测试用例使非常简洁，<strong>易于阅读和维护。</strong></p>
<p>编写错误报告时，应始终<em>提供说明，</em>解释<em>您期望看到的内容</em>，并解释<em>您实际看到的内容</em>。</p>
<p>测试用例的编写方式一般参见如下：</p>
<ol>
<li>用简单的英语描述您要测试的功能。</li>
<li>提供测试的预期结果。这就是为什么许多单元测试称为<em>期望的原因。</em></li>
<li>将其与<em>实际值</em>进行比较<em>。</em></li>
</ol>
<p>当单元测试失败时，<em>错误消息就是您的错误报告。</em></p>
<h2 id="Your-test-descriptions-should-be-clear-enough-to-use-as-documentation"><a href="#Your-test-descriptions-should-be-clear-enough-to-use-as-documentation" class="headerlink" title="Your test descriptions should be clear enough to use as documentation."></a>Your test descriptions should be clear enough to use as documentation.</h2><h2 id="您的测试描述应足够清晰，以至可以当作文档阅读。"><a href="#您的测试描述应足够清晰，以至可以当作文档阅读。" class="headerlink" title="您的测试描述应足够清晰，以至可以当作文档阅读。"></a>您的测试描述应足够清晰，以至可以当作文档阅读。</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> test <span class="keyword">from</span> <span class="string">&#x27;tape&#x27;</span></span><br><span class="line"></span><br><span class="line">test(<span class="string">&#x27;A passing test&#x27;</span>, <span class="function">(<span class="params">assert</span>) =&gt;</span> &#123;</span><br><span class="line">    assert.pass(<span class="string">&#x27;This test will pass.&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    assert.end()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">test(<span class="string">&#x27;Assertions with tape.&#x27;</span>, <span class="function">(<span class="params">assert</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> expected = <span class="string">&#x27;something to test&#x27;</span></span><br><span class="line">    <span class="keyword">const</span> actual = <span class="string">&#x27;sonething to test&#x27;</span></span><br><span class="line"></span><br><span class="line">    assert.equal(</span><br><span class="line">        actual,</span><br><span class="line">        expected,</span><br><span class="line">        <span class="string">&#x27;Given two mismatched values, .equal() should produce a nice bug report&#x27;</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    assert.end()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>If you write tests this way, your test error messages should be clear enough to use as bug reports:</p>
<p>如果你这么写测试用例，则你的测试错误信息将会足够清楚，甚至用来当作 bug 报告来看。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">TAP version 13</span><br><span class="line"><span class="meta">#</span><span class="bash"> A passing <span class="built_in">test</span></span></span><br><span class="line">ok 1 This test will pass.</span><br><span class="line"><span class="meta">#</span><span class="bash"> Assertions with tape.</span></span><br><span class="line">not ok 2 Given two mismatched values, .equal() should produce a nice bug report</span><br><span class="line">  ---</span><br><span class="line">    operator: equal</span><br><span class="line">    expected: &#x27;something to test&#x27;</span><br><span class="line">    actual:   &#x27;sonething to test&#x27;</span><br><span class="line">  ...1..2</span><br><span class="line"><span class="meta">#</span><span class="bash"> tests 2</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> pass 1</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> fail 1</span></span><br></pre></td></tr></table></figure>

<h2 id="Your-automated-test-error-messages-are-your-bug-reports"><a href="#Your-automated-test-error-messages-are-your-bug-reports" class="headerlink" title="Your automated test error messages are your bug reports."></a>Your automated test error messages are your bug reports.</h2><h2 id="您的自动测试错误消息就是您的错误报告。"><a href="#您的自动测试错误消息就是您的错误报告。" class="headerlink" title="您的自动测试错误消息就是您的错误报告。"></a>您的自动测试错误消息就是您的错误报告。</h2><p>Simple tests assertions provide:</p>
<ul>
<li>  Better readability.</li>
<li>  Less code.</li>
<li>  Less maintenance.</li>
</ul>
<p>These features trump all the bells and whistles in the world.</p>
</div><hr></div><nav id="pagination"><div class="pagination"><span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2019 - 2021 By liuarui</div><div class="framework-info"><span>Driven - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv"><i class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span><span></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_site_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.0"></script><script src="/js/fancybox.js?version=1.9.0"></script><script src="/js/sidebar.js?version=1.9.0"></script><script src="/js/copy.js?version=1.9.0"></script><script src="/js/fireworks.js?version=1.9.0"></script><script src="/js/transition.js?version=1.9.0"></script><script src="/js/scroll.js?version=1.9.0"></script><script src="/js/head.js?version=1.9.0"></script><script id="ribbon" src="/js/third-party/canvas-ribbon.js" size="150" alpha="0.6" zIndex="-1" data-click="false"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>